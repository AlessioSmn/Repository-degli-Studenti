<!DOCTYPE html>
<html lang="it">
<head>
	<meta charset="utf-8">
      <title>Repository studenti</title>
      <link rel="stylesheet" type="text/CSS" href="css/themes/dark.css" id="theme">
      <link rel="stylesheet" type="text/CSS" href="css/general.css">
      <link rel="stylesheet" type="text/CSS" href="css/header.css">
      <link rel="stylesheet" type="text/CSS" href="css/navbar.css">
      <link rel="stylesheet" type="text/CSS" href="css/footer.css">
      <link rel="icon" type="image/ICO" href="media/.ico/cherubino_pant541.ico">
      <script src="js/theme/themeControl.js"></script>
      <script src="js/logControl/logout.js"></script>
      <script>
            function saveTheme(){
                  event.preventDefault();

                  const form = document.getElementById('themeForm');

                  // Salvo in cache un array contenente le varibili CSS per i vari colori
                  const customTheme = {
                        '--bgColor': form.elements['bgColor'].value,
                        '--foreColor': form.elements['foreColor'].value,
                        '--primary': form.elements['primary'].value,
                        '--secondary': form.elements['secondary'].value,
                        '--tertiary': form.elements['tertiary'].value,
                        '--shadow': form.elements['shadow'].value
                  };

                  // Salvo l'array serializzato in cache 
                  localStorage.setItem('customThemeInfo', JSON.stringify(customTheme));
            }
            function useTheme() {
                  event.preventDefault();
                  setTheme(CUSTOM_THEME);
            }
      </script>
</head>
<body>
      <header>
            <h1>PAGINA CUSTOM FONT</h1>
      </header>

      <nav>
            <a href="index.php" class="navbarElement">Home</a>
            <a href="personal.php" class="navbarElement currentPage">Area personale</a>
            <a href="search.php" class="navbarElement">Cerca</a>
            <a href="login.php" class="navbarElement">Login</a>
            <a href="signup.php" class="navbarElement">Registrati</a>
            <a href="manual.html" class="navbarElement">Manuale</a>
            <a href="documentation.php" class="navbarElement">Doc-</a>
            <div class="navbarElement navbarDropDown">
                  Tema
                  <div class="themeOptionsContainer">
                        <a class="themeOption" onclick="setTheme('dark')">Scuro</a>
                        <a class="themeOption" onclick="setTheme('grey')">Grigio</a>
                        <a class="themeOption" onclick="setTheme('light')">Chiaro</a>
                        <a class="themeOption" onclick="setTheme('pantone')">Pantone</a>
                        <a class="themeOption" onclick="setTheme('custom')">Neon</a>
                        <a class="themeOption" onclick="setTheme(CUSTOM_THEME)">Custom</a>
                  </div>
            </div>
            <div class="navbarElement logoutElement" onclick="logout()"><span>&#11199;</span> Logout</div>
      </nav>
      
      <article>
            <form id="themeForm">
                  <input type="color" name="bgColor" value="#f6f4f5" style="width:100px"/>
                  <label for="bgColor">Colore dello sfondo</label>
                  <br>
                  <input type="color" name="foreColor" value="#161425" />
                  <label for="foreColor">Colore del testo</label>
                  <br>
                  <input type="color" name="primary" value="#e66465" />
                  <label for="primary">Colore primario</label>
                  <br>
                  <input type="color" name="secondary" value="#066465" />
                  <label for="secondary">Colore secondario</label>
                  <br>
                  <input type="color" name="tertiary" value="#561415" />
                  <label for="tertiary">Colore terziario</label>
                  <br>
                  <input type="color" name="shadow" value="#000000" />
                  <label for="shadow">Ombre</label>
                  <br>
                  <button onclick="saveTheme()">Salva tema</button>
                  <button onclick="useTheme()">utlizza tema</button>
            </form>
      </article>
      <footer>footer</footer>
      <script>
            
            /**
             * Imposta i valori degli input dei colori al valore impostato, se presente
             */
            function setCurrentCustomTheme() {
                  // Controllo che sia stato definito un tema custom
                  const storedCustomTheme = localStorage.getItem('customThemeInfo');

                  // in tal caso scorro tutte le regole
                  if (storedCustomTheme) {
                        // Deserializzo il tema in un array di variabili css
                        const customTheme = JSON.parse(storedCustomTheme);

                        // Per ogni variabile cerco il corrispondente input
                        Object.keys(customTheme).forEach(variable => {

                              // cerco l'elemento input con il nome corrispondente (tolgo per√≤ il '--' quando cerco il nome)
                              const input = document.querySelector(`[name="${variable.replace('--', '')}"]`);

                              // imposto il value corrente
                              if (input) input.value = customTheme[variable];
                        });
                  }
            }
            setCurrentCustomTheme();
      </script>
</body>
</html>